#
# Generated by Chef
#
# logstash agent - Logstash indexing
#
description     "logstash-<%= @name %>"

start on filesystem or runlevel [2345]
stop on runlevel [!2345]

respawn
respawn limit 5 120

setuid <%= node['logstash']['user'] %>
setgid <%= node['logstash']['group'] %>
console log

<%
   args = []
   args << '-server'
   args << '-jar'
   args << @logstash_jar
   args << 'agent'
   args << '--config'
   args << "#{node['logstash']['config_dir']}/#{@name}.conf"
   args << '--log'
   args << "#{node['logstash']['log_dir']}/#{@name}.log"
%>

exec java <%= args.join(' ') %>
